<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-dev] Avatar movement packet optimization
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-dev/2009-February/index.html" >
   <LINK REL="made" HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Avatar%20movement%20packet%20optimization&In-Reply-To=%3CBLU134-W278DDE48AD604CEF9D1382D5B80%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005018.html">
   <LINK REL="Next"  HREF="005034.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-dev] Avatar movement packet optimization</H1>
    <B>Stefan Andersson</B> 
    <A HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Avatar%20movement%20packet%20optimization&In-Reply-To=%3CBLU134-W278DDE48AD604CEF9D1382D5B80%40phx.gbl%3E"
       TITLE="[Opensim-dev] Avatar movement packet optimization">stefan at tribalmedia.se
       </A><BR>
    <I>Fri Feb 13 08:42:28 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005018.html">[Opensim-dev] Avatar movement packet optimization
</A></li>
        <LI>Next message: <A HREF="005034.html">[Opensim-dev] Avatar movement packet optimization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5031">[ date ]</a>
              <a href="thread.html#5031">[ thread ]</a>
              <a href="subject.html#5031">[ subject ]</a>
              <a href="author.html#5031">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> Resizing the terseupdate packet size is going to be placed in to ModRex at least, that's why in the patch SendAvatarTerseUpdate method is marked as virtual.
</I>

 

Just a very quick short one; (yeah right)

 

Not talking about this patch in particular, just realized there's something that app devs probably should be made aware of:


In OpenSim, there's been an implicit understanding (that we should probably discuss and make explicit) that;

 

1) Marking stuff as 'virtual' because of the need to subclass in a particular proprietary application should never be a problem. This strenghtens the API.

 

2) Going from 'private' to 'protected' because of the need to subclass in a particular proprietary application should never be a problem. This strenghtens the API.

 

3) Introducing extra layers of indirection because of the need to re-direct control flow in a particular proprietary application should never be a problem. This strenghtens the API.

 

4) Introducing stuff directly into core that is not used by core because a particular proprietary feature demands it, will always be a problem. Instead, do 1) or 2) or 3).

 

5) Going from 'protected' to 'public' because a particular proprietary feature demands it, will always be a problem. Instead, do 1) or 2) or 3).

Best regards,
Stefan Andersson
Tribal Media AB

&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">mikko.pallari at adminotech.com</A>
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
</I>&gt;<i> Date: Thu, 12 Feb 2009 14:26:26 +0100
</I>&gt;<i> Subject: Re: [Opensim-dev] Avatar movement packet optimization
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Yes, 'dramatic' as in positive.
</I>&gt;<i> 
</I>&gt;<i> The changes introduced in the patch work for LL clients also and propably for OpenMetaverse clients too, but I haven't tested this patch with them.
</I>&gt;<i> 
</I>&gt;<i> Resizing the terseupdate packet size is going to be placed in to ModRex at least, that's why in the patch SendAvatarTerseUpdate method is marked as virtual.
</I>&gt;<i> 
</I>&gt;<i> Sean Dague wrote:
</I>&gt;<i> &gt; Very cool to see this patch. There is some feedback in the mantis tracker about adjusting the way types are used. It would be great if you could respin the patch based on that so we could get this in.
</I>&gt;<i> 
</I>&gt;<i> Already done.
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Mikko
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>] On Behalf Of Dirk Krause
</I>&gt;<i> Sent: 12. helmikuuta 2009 13:36
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
</I>&gt;<i> Subject: Re: [Opensim-dev] Avatar movement packet optimization
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> - dramatic in terms of 'positive'?
</I>&gt;<i> - to take advantage of the client side changes one would need to change the viewer source (or take the Rex Viewer) then?
</I>&gt;<i> I also take it that OpenMetaverse based viewers (like IdealistViewer) would need a patch for OpenMetaverse?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> even with the 'server only' optimization, it still is a great contribution. Should be tested though, and I wonder what would be a smart way to do this.
</I>&gt;<i> 
</I>&gt;<i> Best,
</I>&gt;<i> Dirk/Bart
</I>&gt;<i> 
</I>&gt;<i> -----Urspr&#252;ngliche Nachricht-----
</I>&gt;<i> Von: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>] Im Auftrag von Mikko Pallari
</I>&gt;<i> Gesendet: Donnerstag, 12. Februar 2009 12:16
</I>&gt;<i> An: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
</I>&gt;<i> Betreff: Re: [Opensim-dev] Avatar movement packet optimization
</I>&gt;<i> 
</I>&gt;<i> That optimization did this and also reduced the terseupdate packet size. That needed changes to protocol, and because we can't change the protocol with Linded client, the effect won't be so dramatic here.
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Mikko
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>] On Behalf Of Jeroen van Veen
</I>&gt;<i> Sent: 12. helmikuuta 2009 11:15
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
</I>&gt;<i> Subject: Re: [Opensim-dev] Avatar movement packet optimization
</I>&gt;<i> 
</I>&gt;<i> i saw that robotdemo a while ago at <A HREF="http://community.rexdeveloper.org/.">http://community.rexdeveloper.org/.</A> It's
</I>&gt;<i> the same optimization? That was really some impressive cool stuff. keep up the
</I>&gt;<i> good work!
</I>&gt;<i> 
</I>&gt;<i> Jeroen
</I>&gt;<i> 
</I>&gt;<i> On Wednesday 11 February 2009 18:59:19 Tommi Laukkanen wrote:
</I>&gt;<i> &gt; Nice!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We need more work like this.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Tommi
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Wed, Feb 11, 2009 at 1:21 PM, Mikko Pallari
</I>&gt;<i> &gt; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">mikko.pallari at adminotech.com</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Hi,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I have made a patch to optimize number of packets to enable even more
</I>&gt;<i> &gt; &gt; users in simulator. I have submitted this patch to mantis and you can
</I>&gt;<i> &gt; &gt; review it here: <A HREF="http://opensimulator.org/mantis/view.php?id=3136">http://opensimulator.org/mantis/view.php?id=3136</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; And as described in mantis this packet should increase the max number of
</I>&gt;<i> &gt; &gt; avatars the server can handle. It combines many terse update packets in
</I>&gt;<i> &gt; &gt; to one packet.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Our initial tests show that:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; - two avatars moving in a circle with optimization: 30-60 packets per
</I>&gt;<i> &gt; &gt; second on client
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; - two avatars moving in a circle without optimization: 40-70 packets per
</I>&gt;<i> &gt; &gt; second on client
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Cheers,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Mikko Pallari
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Opensim-dev mailing list
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-dev mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-dev mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-dev mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-dev mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/opensim-dev/attachments/20090213/a0a678fa/attachment.html">https://lists.berlios.de/pipermail/opensim-dev/attachments/20090213/a0a678fa/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005018.html">[Opensim-dev] Avatar movement packet optimization
</A></li>
	<LI>Next message: <A HREF="005034.html">[Opensim-dev] Avatar movement packet optimization
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5031">[ date ]</a>
              <a href="thread.html#5031">[ thread ]</a>
              <a href="subject.html#5031">[ subject ]</a>
              <a href="author.html#5031">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-dev">More information about the Opensim-dev
mailing list</a><br>
</body></html>
