<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-dev] Upcoming work on alternative client stack
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-dev/2008-August/index.html" >
   <LINK REL="made" HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Upcoming%20work%20on%20alternative%20client%20stack&In-Reply-To=%3CD6A10607992B12488CE4BE6021C28F950539BB55%40orsmsx415.amr.corp.intel.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002622.html">
   <LINK REL="Next"  HREF="002630.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-dev] Upcoming work on alternative client stack</H1>
    <B>Hurliman, John</B> 
    <A HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Upcoming%20work%20on%20alternative%20client%20stack&In-Reply-To=%3CD6A10607992B12488CE4BE6021C28F950539BB55%40orsmsx415.amr.corp.intel.com%3E"
       TITLE="[Opensim-dev] Upcoming work on alternative client stack">john.hurliman at intel.com
       </A><BR>
    <I>Tue Aug 19 03:48:22 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002622.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
        <LI>Next message: <A HREF="002630.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2624">[ date ]</a>
              <a href="thread.html#2624">[ thread ]</a>
              <a href="subject.html#2624">[ subject ]</a>
              <a href="author.html#2624">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

-----Original Message-----
From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>
[mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>] On Behalf Of Mike Mazur
Sent: Monday, August 18, 2008 5:16 PM
To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
Subject: Re: [Opensim-dev] Upcoming work on alternative client stack

Hi,

On Mon, 18 Aug 2008 16:07:45 -0700
&quot;Hurliman, John&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">john.hurliman at intel.com</A>&gt; wrote:

&gt;<i> From my testing, any time you deal with a P/Invoke wall you need to
</I>&gt;<i> seriously evaluate whether it is worth it.
</I>
I'd just like to clarify a few things.

First, I'm not trying to do any P/Invoke stuff. The funsl stack I'm
working on is strictly C# managed code. The C/C++ files generated by
the compiler can be used in other projects if they are developed in C
or C++.

Second, the performance bottlenecks were mainly with the GC. We found
that during login the number of GC events increased dramatically. The
solution for this is a working PacketPool. There's also the issue of
unpacking the entire packet every time it comes in, immediately as it
comes in, when all that's needed is a subset of the data. The solution
to this is lazily extracting the data right before the client stack
calls out to the core.

Thanks,
Mike


Ahh, I misunderstood and thought this was an unmanaged/managed hybrid.
Anything that reduces heap allocations / fragmentation is going to be a
big win. That's what my work with the types has been focusing on. Let me
know if you start looking at the PacketPool, I don't have free cycles to
dedicate to it right now but I have drafted some ideas out on paper. As
far as unpacking the entire packet, I made the design assumption that
you want to access all of the data in a packet at some point, or at
least enough of it that it makes sense to decode the entire thing in a
single pass. The way SL packets are laid out means you have to parse
through the entire thing up to the field you are interested in, because
of variable field and block sizes. Stuffing the incoming UDP buffers in
a queue and delaying decoding could address your latter issue.
Regardless, I'm interested in any possible new methods of handling
packet decoding/encoding and will lend a hand to profiling and
comparison when the code is ready.

John

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002622.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
	<LI>Next message: <A HREF="002630.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2624">[ date ]</a>
              <a href="thread.html#2624">[ thread ]</a>
              <a href="subject.html#2624">[ subject ]</a>
              <a href="author.html#2624">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-dev">More information about the Opensim-dev
mailing list</a><br>
</body></html>
