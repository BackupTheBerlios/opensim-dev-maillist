<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-dev] Upcoming work on alternative client stack
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-dev/2008-August/index.html" >
   <LINK REL="made" HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Upcoming%20work%20on%20alternative%20client%20stack&In-Reply-To=%3C48AAD1C3.3020904%40t-data.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002624.html">
   <LINK REL="Next"  HREF="002629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-dev] Upcoming work on alternative client stack</H1>
    <B>Melanie</B> 
    <A HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Upcoming%20work%20on%20alternative%20client%20stack&In-Reply-To=%3C48AAD1C3.3020904%40t-data.com%3E"
       TITLE="[Opensim-dev] Upcoming work on alternative client stack">melanie at t-data.com
       </A><BR>
    <I>Tue Aug 19 15:59:31 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002624.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
        <LI>Next message: <A HREF="002629.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2630">[ date ]</a>
              <a href="thread.html#2630">[ thread ]</a>
              <a href="subject.html#2630">[ subject ]</a>
              <a href="author.html#2630">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

it's just the concept or partial or incremental or lazy decoding i 
have a bed feeling about.
As jhurliman stated, there is really no way to make a partial 
unpacking less expensive than a full one, you might wind up 
repeating the operation if you find out you need more data than 
initially requested and I believe that will eat up all benefits. 
Complete unpack on reception is the way to go, IMHO. That could be 
done in another thread, for makeing it more responsive to the 
client, but that is a look &amp; feel thing, it doesn't change the 
principle of a single unpack run being preferable to multiple ones. 
 From most packets, all data is needed. Not all of it is used, 
because we have so many unimplemented features, but if we were 
feature complete, we would pretty much use every field in every packet.

Melanie




Hurliman, John wrote:
&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>
</I>&gt;<i> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev-bounces at lists.berlios.de</A>] On Behalf Of Mike Mazur
</I>&gt;<i> Sent: Monday, August 18, 2008 5:16 PM
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
</I>&gt;<i> Subject: Re: [Opensim-dev] Upcoming work on alternative client stack
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> On Mon, 18 Aug 2008 16:07:45 -0700
</I>&gt;<i> &quot;Hurliman, John&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">john.hurliman at intel.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> From my testing, any time you deal with a P/Invoke wall you need to
</I>&gt;&gt;<i> seriously evaluate whether it is worth it.
</I>&gt;<i> 
</I>&gt;<i> I'd just like to clarify a few things.
</I>&gt;<i> 
</I>&gt;<i> First, I'm not trying to do any P/Invoke stuff. The funsl stack I'm
</I>&gt;<i> working on is strictly C# managed code. The C/C++ files generated by
</I>&gt;<i> the compiler can be used in other projects if they are developed in C
</I>&gt;<i> or C++.
</I>&gt;<i> 
</I>&gt;<i> Second, the performance bottlenecks were mainly with the GC. We found
</I>&gt;<i> that during login the number of GC events increased dramatically. The
</I>&gt;<i> solution for this is a working PacketPool. There's also the issue of
</I>&gt;<i> unpacking the entire packet every time it comes in, immediately as it
</I>&gt;<i> comes in, when all that's needed is a subset of the data. The solution
</I>&gt;<i> to this is lazily extracting the data right before the client stack
</I>&gt;<i> calls out to the core.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Mike
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Ahh, I misunderstood and thought this was an unmanaged/managed hybrid.
</I>&gt;<i> Anything that reduces heap allocations / fragmentation is going to be a
</I>&gt;<i> big win. That's what my work with the types has been focusing on. Let me
</I>&gt;<i> know if you start looking at the PacketPool, I don't have free cycles to
</I>&gt;<i> dedicate to it right now but I have drafted some ideas out on paper. As
</I>&gt;<i> far as unpacking the entire packet, I made the design assumption that
</I>&gt;<i> you want to access all of the data in a packet at some point, or at
</I>&gt;<i> least enough of it that it makes sense to decode the entire thing in a
</I>&gt;<i> single pass. The way SL packets are laid out means you have to parse
</I>&gt;<i> through the entire thing up to the field you are interested in, because
</I>&gt;<i> of variable field and block sizes. Stuffing the incoming UDP buffers in
</I>&gt;<i> a queue and delaying decoding could address your latter issue.
</I>&gt;<i> Regardless, I'm interested in any possible new methods of handling
</I>&gt;<i> packet decoding/encoding and will lend a hand to profiling and
</I>&gt;<i> comparison when the code is ready.
</I>&gt;<i> 
</I>&gt;<i> John
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-dev mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002624.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
	<LI>Next message: <A HREF="002629.html">[Opensim-dev] Upcoming work on alternative client stack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2630">[ date ]</a>
              <a href="thread.html#2630">[ thread ]</a>
              <a href="subject.html#2630">[ subject ]</a>
              <a href="author.html#2630">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-dev">More information about the Opensim-dev
mailing list</a><br>
</body></html>
