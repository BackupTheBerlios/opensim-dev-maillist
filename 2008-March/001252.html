<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-dev] Fwd: trouble with appearance persistence (r4004)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-dev/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Fwd%3A%20trouble%20with%20appearance%20persistence%20%28r4004%29&In-Reply-To=%3C968119.6526.qm%40web23014.mail.ird.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001244.html">
   <LINK REL="Next"  HREF="001254.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-dev] Fwd: trouble with appearance persistence (r4004)</H1>
    <B>Michael Wright</B> 
    <A HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Fwd%3A%20trouble%20with%20appearance%20persistence%20%28r4004%29&In-Reply-To=%3C968119.6526.qm%40web23014.mail.ird.yahoo.com%3E"
       TITLE="[Opensim-dev] Fwd: trouble with appearance persistence (r4004)">michaelwri22 at yahoo.co.uk
       </A><BR>
    <I>Wed Mar 26 19:36:05 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001244.html">[Opensim-dev] Fwd: trouble with appearance persistence (r4004)
</A></li>
        <LI>Next message: <A HREF="001254.html">[Opensim-dev] Proposal for using OpenID in OpenSim
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1252">[ date ]</a>
              <a href="thread.html#1252">[ thread ]</a>
              <a href="subject.html#1252">[ subject ]</a>
              <a href="author.html#1252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>yeah as Stefan said, at the moment avatar appearance persistence is mysql only, this is mainly due to the fact we only have a mysql Mapper for the database wrapper it is using. So we need more database connectors/mappers based of OpenSimDatabaseConnector  (in opensim.framework.data). 

But Hopefully soon, we'll get more mappers for the various other db's. I think the main thing which has stopped this happening so far is the question of where we are going with the databases in general. Are we going to keep using the wrapper that Avatar factory uses (currently I believe its the only thing in opensim using that), or are we going with nhibernate, or with something else.

The other way is to write a new AvatarFactory module that uses a different db wrapper/interface. This is the idea, if someone wanted a appearance factory that used a different database interface or that got the data from a central server. 



Stefan Andersson &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">stefan at tribalmedia.se</A>&gt; wrote:    .hmmessage P { margin:0px; padding:0px } body.hmmessage { FONT-SIZE: 10pt; FONT-FAMILY:Tahoma }  Yes, avatar appearance only works with MySQL.


/Stefan


---------------------------------
&gt;<i> Date: Wed, 26 Mar 2008 05:28:52 -0700
</I>&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">aerowolf at gmail.com</A>
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>
</I>&gt;<i> Subject: [Opensim-dev] Fwd: trouble with appearance persistence (r4004)
</I>&gt;<i> 
</I>&gt;<i> justincc clued me in that this version I was testing wasn't truly
</I>&gt;<i> r4004 (I must have checked out a release tag without remembering), but
</I>&gt;<i> the problem does still exist with the true trunk.  He also said that
</I>&gt;<i> mw doesn't monitor -users, so I'm forwarding here.
</I>&gt;<i> 
</I>&gt;<i> My environment is MacOSX 10.5.2, Mono 1.9 (tarball), x86.
</I>&gt;<i> 
</I>&gt;<i> Please see the tag end of the forwarded message for the log from trunk r4004.
</I>&gt;<i> 
</I>&gt;<i> -Kyle H
</I>&gt;<i> 
</I>&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> From: Kyle Hamilton &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">aerowolf at gmail.com</A>&gt;
</I>&gt;<i> Date: Wed, Mar 26, 2008 at 4:46 AM
</I>&gt;<i> Subject: trouble with appearance persistence (r4004)
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-users at lists.berlios.de</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I'm trying to use appearance persistence in r4004, but I seem to be
</I>&gt;<i>  running into a trouble that it's hard-coded to use MySQL (I'm using
</I>&gt;<i>  SQLite).  In my OpenSim.ini, I have all MySQL lines commented out.
</I>&gt;<i> 
</I>&gt;<i>  It starts up fine, but once I try to log in Test User, I get an exception:
</I>&gt;<i> 
</I>&gt;<i>  Region# :
</I>&gt;<i>  04:38:36 - [LOGIN]: Client Version Second Life Release 1.19.0.5 for Test User
</I>&gt;<i>  04:38:36 - [LOGIN]: Authenticating Test User
</I>&gt;<i>  04:38:36 - [INVENTORY]: Found root folder for user with ID
</I>&gt;<i>  f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be.  Retrieving inventory contents.
</I>&gt;<i>  04:38:36 - [CONNECTION DEBUGGING]: Setting up CAPS handler for
</I>&gt;<i>  f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be at
</I>&gt;<i>  3fb8eb16-4c46-401a-823b-4cf91cb5
</I>&gt;<i>  04:38:36 - [CAPS]: Registering CAPS handlers
</I>&gt;<i>  04:38:36 - [CONNECTION DEBUGGING]: Creating new circuit code
</I>&gt;<i>  (314156373) for f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be
</I>&gt;<i>  04:38:36 - [SQLITE]: Syncing user database: 1 users stored
</I>&gt;<i>  04:38:37 - [UDPSERVER]: Adding New Client
</I>&gt;<i>  04:38:37 - [CLIENT]: Started up new client thread to handle incoming request
</I>&gt;<i>  04:38:37 - [CLIENT]: Got authenticated connection from 127.0.0.1:50971
</I>&gt;<i>  04:38:37 - [CLIENT]: Adding viewer agent to scene
</I>&gt;<i>  04:38:37 - [CONNECTION DEBUGGING]: Creating new client for
</I>&gt;<i>  f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be
</I>&gt;<i>  04:38:37 - [GROUP]: Adding Test User to OpenSimulator Tester group
</I>&gt;<i>  [APPLICATION]:
</I>&gt;<i>  APPLICATION EXCEPTION DETECTED: System.UnhandledExceptionEventArgs
</I>&gt;<i> 
</I>&gt;<i>  Exception: System.ArgumentException: Keyword not supported.
</I>&gt;<i>  Parameter name: URI
</I>&gt;<i>   at MySql.Data.MySqlClient.MySqlConnectionStringBuilder.GetKey
</I>&gt;<i>  (System.String key) [0x00000]
</I>&gt;<i>   at MySql.Data.MySqlClient.MySqlConnectionStringBuilder.SetValue
</I>&gt;<i>  (System.String keyword, System.Object value) [0x00000]
</I>&gt;<i>   at MySql.Data.MySqlClient.MySqlConnectionStringBuilder.set_Item
</I>&gt;<i>  (System.String key, System.Object value) [0x00000]
</I>&gt;<i>   at System.Data.Common.DbConnectionStringBuilder.set_ConnectionString
</I>&gt;<i>  (System.String value) [0x00000]
</I>&gt;<i>   at MySql.Data.MySqlClient.MySqlConnectionStringBuilder..ctor
</I>&gt;<i>  (System.String connectionString) [0x00000]
</I>&gt;<i>   at MySql.Data.MySqlClient.MySqlConnection.set_ConnectionString
</I>&gt;<i>  (System.String value) [0x00000]
</I>&gt;<i>   at MySql.Data.MySqlClient.MySqlConnection..ctor (System.String
</I>&gt;<i>  connectionString) [0x00000]
</I>&gt;<i>   at (wrapper remoting-invoke-with-check)
</I>&gt;<i>  MySql.Data.MySqlClient.MySqlConnection:.ctor (string)
</I>&gt;<i>   at OpenSim.Framework.Data.MySQLDatabaseMapper.GetNewConnection () [0x00000]
</I>&gt;<i>   at TribalMedia.Framework.Data.BaseTableMapper.WithConnection
</I>&gt;<i>  (System.Action`1 action) [0x00000]
</I>&gt;<i>   at TribalMedia.Framework.Data.BaseTableMapper`2[OpenSim.Region.Environment.Modules.AppearanceRowMapper,System.Guid].TryGetValue
</I>&gt;<i>  (Guid primaryKey,
</I>&gt;<i>  OpenSim.Region.Environment.Modules.AppearanceRowMapper&amp; value)
</I>&gt;<i>  [0x00000]
</I>&gt;<i>   at OpenSim.Region.Environment.Modules.AppearanceTableMapper.TryGetValue
</I>&gt;<i>  (Guid presenceID, OpenSim.Region.Environment.Scenes.AvatarAppearance&amp;
</I>&gt;<i>  val) [0x00000]
</I>&gt;<i>   at OpenSim.Region.Environment.Modules.AvatarFactoryModule.CheckDatabase
</I>&gt;<i>  (LLUUID avatarId) [0x00000]
</I>&gt;<i>   at OpenSim.Region.Environment.Modules.AvatarFactoryModule.TryGetAvatarAppearance
</I>&gt;<i>  (LLUUID avatarId, OpenSim.Region.Environment.Scenes.AvatarAppearance&amp;
</I>&gt;<i>  appearance) [0x00000]
</I>&gt;<i>   at OpenSim.Region.Environment.Scenes.Scene.GetAvatarAppearance
</I>&gt;<i>  (IClientAPI client,
</I>&gt;<i>  OpenSim.Region.Environment.Scenes.AvatarAppearance&amp; appearance)
</I>&gt;<i>  [0x00000]
</I>&gt;<i>   at OpenSim.Region.Environment.Scenes.Scene.CreateAndAddScenePresence
</I>&gt;<i>  (IClientAPI client, Boolean child) [0x00000]
</I>&gt;<i>   at OpenSim.Region.Environment.Scenes.Scene.AddNewClient (IClientAPI
</I>&gt;<i>  client, Boolean child) [0x00000]
</I>&gt;<i>   at OpenSim.Region.ClientStack.ClientView.InitNewClient () [0x00000]
</I>&gt;<i>   at OpenSim.Region.ClientStack.ClientView.AuthUser () [0x00000]
</I>&gt;<i> 
</I>&gt;<i>  Application is terminating: True
</I>&gt;<i> 
</I>&gt;<i>  The apparent problem is:
</I>&gt;<i>  appearance_connection_string = &quot;URI=file:Appearance.db,version=3&quot;;
</I>&gt;<i> 
</I>&gt;<i>  This is a valid connection string for SQLite, but not MySQL.
</I>&gt;<i> 
</I>&gt;<i>  I have tried adding:
</I>&gt;<i>  appearance_plugin=&quot;OpenSim.Framework.Data.SQLite.dll&quot;
</I>&gt;<i> 
</I>&gt;<i>  but it's not apparently recognized.  The asset_database line is:
</I>&gt;<i>  asset_database = &quot;sqlite&quot;
</I>&gt;<i> 
</I>&gt;<i>  This exception does not occur if I have:
</I>&gt;<i>  appearance_persist = false
</I>&gt;<i> 
</I>&gt;<i>  I'm given to understand that since I've been &quot;contaminated&quot; by the GPL
</I>&gt;<i>  and membership to sldev, I cannot submit patches.
</I>&gt;<i> 
</I>&gt;<i>  I would prefer not to have to run an instance of MySQL on my machine.
</I>&gt;<i> 
</I>&gt;<i>  -Kyle H
</I>&gt;<i> 
</I>&gt;<i> [[appended: the log from r4004 trunk]]
</I>&gt;<i> 
</I>&gt;<i> 05:21:43 - [LOGIN]: Received login request message from user Test User
</I>&gt;<i> 05:21:43 - [LOGIN]: Client version: Second Life Release 1.19.0.5
</I>&gt;<i> 05:21:43 - [LOGIN]: Client requested start location: last
</I>&gt;<i> 05:21:43 - [LOGIN]: Authenticating Test User
</I>&gt;<i> 05:21:43 - [INVENTORY]: Found root folder for user with ID
</I>&gt;<i> f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be.  Retrieving inventory contents.
</I>&gt;<i> 05:21:43 - [CAPS]: Sending new CAPS seed url
</I>&gt;<i> <A HREF="http://127.0.0.1:9000/CAPS/e00b33cd-df7c-4921-8174-d3b902790000/">http://127.0.0.1:9000/CAPS/e00b33cd-df7c-4921-8174-d3b902790000/</A> to
</I>&gt;<i> client f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be
</I>&gt;<i> 05:21:43 - [LOGIN]: Telling region kyanha @ 255,255 (127.0.0.1:9000)
</I>&gt;<i> to expect user connection
</I>&gt;<i> 05:21:43 - [CAPS]: Setting up CAPS handler for root agent
</I>&gt;<i> f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be in kyanha
</I>&gt;<i> 05:21:43 - [CONNECTION DEBUGGING]: Creating new circuit code
</I>&gt;<i> (314156373) for avatar f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be at kyanha
</I>&gt;<i> 05:21:43 - [SQLITE]: Syncing user database: 1 users stored
</I>&gt;<i> 05:21:43 - [LOGIN]: Authentication of user Test User successful.
</I>&gt;<i> Sending response to client.
</I>&gt;<i> 05:21:45 - [UDPSERVER]: Adding New Client
</I>&gt;<i> 05:21:45 - [CLIENT]: Started up new client thread to handle incoming request
</I>&gt;<i> 05:21:45 - [CLIENT]: Got authenticated connection from 127.0.0.1:51034
</I>&gt;<i> 05:21:45 - [CLIENT]: Adding viewer agent to scene
</I>&gt;<i> 05:21:45 - [CONNECTION DEBUGGING]: Creating new client for
</I>&gt;<i> f94a3dc1-d7b4-4ee7-9c1b-8e4acf77b4be at kyanha
</I>&gt;<i> 05:21:45 - [GROUP]: Adding Test User to OpenSimulator Tester group
</I>&gt;<i> 05:21:45 - [REGION]: Add New Scene Presence
</I>&gt;<i> [APPLICATION]:
</I>&gt;<i> APPLICATION EXCEPTION DETECTED: System.UnhandledExceptionEventArgs
</I>&gt;<i> 
</I>&gt;<i> Exception: System.ArgumentException: Keyword not supported.
</I>&gt;<i> Parameter name: URI
</I>&gt;<i>  at MySql.Data.MySqlClient.MySqlConnectionStringBuilder.GetKey
</I>&gt;<i> (System.String key) [0x00000]
</I>&gt;<i>  at MySql.Data.MySqlClient.MySqlConnectionStringBuilder.SetValue
</I>&gt;<i> (System.String keyword, System.Object value) [0x00000]
</I>&gt;<i>  at MySql.Data.MySqlClient.MySqlConnectionStringBuilder.set_Item
</I>&gt;<i> (System.String key, System.Object value) [0x00000]
</I>&gt;<i>  at System.Data.Common.DbConnectionStringBuilder.set_ConnectionString
</I>&gt;<i> (System.String value) [0x00000]
</I>&gt;<i>  at MySql.Data.MySqlClient.MySqlConnectionStringBuilder..ctor
</I>&gt;<i> (System.String connectionString) [0x00000]
</I>&gt;<i>  at MySql.Data.MySqlClient.MySqlConnection.set_ConnectionString
</I>&gt;<i> (System.String value) [0x00000]
</I>&gt;<i>  at MySql.Data.MySqlClient.MySqlConnection..ctor (System.String
</I>&gt;<i> connectionString) [0x00000]
</I>&gt;<i>  at (wrapper remoting-invoke-with-check)
</I>&gt;<i> MySql.Data.MySqlClient.MySqlConnection:.ctor (string)
</I>&gt;<i>  at OpenSim.Framework.Data.MySQLMapper.MySQLDatabaseMapper.GetNewConnection
</I>&gt;<i> () [0x00000]
</I>&gt;<i>  at OpenSim.Framework.Data.Base.BaseTableMapper.WithConnection
</I>&gt;<i> (System.Action`1 action) [0x00000]
</I>&gt;<i>  at OpenSim.Framework.Data.Base.BaseTableMapper`2[OpenSim.Region.Modules.AvatarFactory.AppearanceRowMapper,System.Guid].TryGetValue
</I>&gt;<i> (Guid primaryKey,
</I>&gt;<i> OpenSim.Region.Modules.AvatarFactory.AppearanceRowMapper&amp; value)
</I>&gt;<i> [0x00000]
</I>&gt;<i>  at OpenSim.Region.Modules.AvatarFactory.AppearanceTableMapper.TryGetValue
</I>&gt;<i> (Guid presenceID, OpenSim.Region.Environment.Scenes.AvatarAppearance&amp;
</I>&gt;<i> val) [0x00000]
</I>&gt;<i>  at OpenSim.Region.Modules.AvatarFactory.AvatarFactoryModule.CheckDatabase
</I>&gt;<i> (LLUUID avatarId) [0x00000]
</I>&gt;<i>  at OpenSim.Region.Modules.AvatarFactory.AvatarFactoryModule.TryGetAvatarAppearance
</I>&gt;<i> (LLUUID avatarId, OpenSim.Region.Environment.Scenes.AvatarAppearance&amp;
</I>&gt;<i> appearance) [0x00000]
</I>&gt;<i>  at OpenSim.Region.Environment.Scenes.Scene.GetAvatarAppearance
</I>&gt;<i> (IClientAPI client,
</I>&gt;<i> OpenSim.Region.Environment.Scenes.AvatarAppearance&amp; appearance)
</I>&gt;<i> [0x00000]
</I>&gt;<i>  at OpenSim.Region.Environment.Scenes.Scene.CreateAndAddScenePresence
</I>&gt;<i> (IClientAPI client, Boolean child) [0x00000]
</I>&gt;<i>  at OpenSim.Region.Environment.Scenes.Scene.AddNewClient (IClientAPI
</I>&gt;<i> client, Boolean child) [0x00000]
</I>&gt;<i>  at OpenSim.Region.ClientStack.ClientView.InitNewClient () [0x00000]
</I>&gt;<i>  at OpenSim.Region.ClientStack.ClientView.AuthUser () [0x00000]
</I>&gt;<i> 
</I>&gt;<i> Application is terminating: True
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-dev mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>_______________________________________________
Opensim-dev mailing list
<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>


       
---------------------------------
Sent from Yahoo! Mail.
More Ways to Keep in Touch.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/opensim-dev/attachments/20080326/dc319f32/attachment.html">https://lists.berlios.de/pipermail/opensim-dev/attachments/20080326/dc319f32/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001244.html">[Opensim-dev] Fwd: trouble with appearance persistence (r4004)
</A></li>
	<LI>Next message: <A HREF="001254.html">[Opensim-dev] Proposal for using OpenID in OpenSim
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1252">[ date ]</a>
              <a href="thread.html#1252">[ thread ]</a>
              <a href="subject.html#1252">[ subject ]</a>
              <a href="author.html#1252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-dev">More information about the Opensim-dev
mailing list</a><br>
</body></html>
