<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-dev] Proposal for removing &quot;ERROR: There was an error while scanning assembly:&quot; message
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-dev/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Proposal%20for%20removing%20%22ERROR%3A%20There%20was%20an%20error%0A%20while%20scanning%20assembly%3A%22%20message&In-Reply-To=%3CBLU134-W17B638AB482A5A7AB4D7D0D5E60%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001489.html">
   <LINK REL="Next"  HREF="001482.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-dev] Proposal for removing &quot;ERROR: There was an error while scanning assembly:&quot; message</H1>
    <B>Stefan Andersson</B> 
    <A HREF="mailto:opensim-dev%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-dev%5D%20Proposal%20for%20removing%20%22ERROR%3A%20There%20was%20an%20error%0A%20while%20scanning%20assembly%3A%22%20message&In-Reply-To=%3CBLU134-W17B638AB482A5A7AB4D7D0D5E60%40phx.gbl%3E"
       TITLE="[Opensim-dev] Proposal for removing &quot;ERROR: There was an error while scanning assembly:&quot; message">stefan at tribalmedia.se
       </A><BR>
    <I>Sun Apr 20 20:58:46 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001489.html">[Opensim-dev] [Opensim-users] Proposal for removing &quot;ERROR: There was an	error while scanning assembly:&quot; message
</A></li>
        <LI>Next message: <A HREF="001482.html">[Opensim-dev] Proposal for removing &quot;ERROR: There was an error while scanning assembly:&quot; message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1476">[ date ]</a>
              <a href="thread.html#1476">[ thread ]</a>
              <a href="subject.html#1476">[ subject ]</a>
              <a href="author.html#1476">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Justin,
 
First: we should strive to have one system/paradigm to maintain plugins. (We were supposed to have one system/paradigm to handle config files too, but we've all seen how far we've come on that...)
 
Second: A plugin handling infrastructure ain't no rocket science; and should not be construed as such. If we gave our current module system some love (as in refactoring and care) I'm pretty sure it can be made into something sexy, simple and solid.
 
Whatever we do, we should support
a) pick-up loading of modules (shared/non-shared region,and application) from one designated pick-up directory
b) explicit loading of modules (shared/non-shared region,and application) via path in config file
 
Best,
/Stefan
 



&gt;<i> Date: Sun, 20 Apr 2008 17:51:12 +0100&gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">jjustincc at googlemail.com</A>&gt; To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>&gt; CC: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-users at lists.berlios.de</A>&gt; Subject: Re: [Opensim-dev] Proposal for removing &quot;ERROR: There was an error while scanning assembly:&quot; message&gt; &gt; Stefan Andersson wrote:&gt; &gt; Justin,&gt; &gt; &gt; &gt; what was the problem with moving plug-in dll's to a separate directory?&gt; &gt; &gt; &gt; Or, doesn't mono plugins support loading named plugins from an xml file, &gt; &gt; for example?&gt; &gt; &gt; &gt; Wouldn't either of these solve the problem?&gt; &gt; Stefan,&gt; &gt; The mono addins package doesn't appear to support picking up modules &gt; from a root directory different from the one in which the assembly &gt; loading the plugins is situated. The directory you give the addins &gt; manager on initialization only appears to place the addin caching &gt; information in a different directory instead. Possibly this is as yet &gt; incomplete functionality.&gt; &gt; The xml in the addins directory looks tantalisingly like it should allow &gt; the naming of different plugin directories, but from reading the code &gt; this doesn't appear to be the case.&gt; &gt; I haven't done much more experimentation, mainly because I'm beginning &gt; to think it would be better if we re-used the same module loading code &gt; we use to load region modules to load application 'plugins'. This would &gt; mean removing the mono addins manager. The cons of this are&gt; &gt; * We end up writing (and maintaining) our own plugin code, though much &gt; of this is written already for region modules.&gt; * We lose the ability to have a multiple application plugin cache, &gt; though I'm not sure how useful this is for us.&gt; * We lose the ability to version plugins - we would have to write this &gt; in our own code.&gt; &gt; The pro is&gt; &gt; * We get what will probably be a simpler to understand system without &gt; the complexity of maintaining an addins cache and the bugs which result. &gt; Mono.Addins pretty much has as much documentation as our own code, but &gt; at least we wrote our own code...&gt; &gt; On the whole, I think the pro outweighs the cons - particularly as it &gt; seems odd for us to maintain two distinct plugin systems. Any changes &gt; we make will also be with a view to enhancing the current modularization &gt; a little further down the road (e.g. to allow the explicit selection of &gt; plugins).&gt; &gt; Thoughts?&gt; &gt; &gt; &gt; &gt; &gt; Best,&gt; &gt; Stefan&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; ------------------------------------------------------------------------&gt; &gt; &gt; &gt; &gt; Date: Fri, 18 Apr 2008 20:00:38 +0100&gt; &gt; &gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">jjustincc at googlemail.com</A>&gt; &gt; &gt; To: <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-dev at lists.berlios.de</A>; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">opensim-users at lists.berlios.de</A>&gt; &gt; &gt; Subject: [Opensim-dev] Proposal for removing &quot;ERROR: There was an &gt; &gt; error while scanning assembly:&quot; messages&gt; &gt; &gt;&gt; &gt; &gt; Hello,&gt; &gt; &gt;&gt; &gt; &gt; This is a technical post but I'm copying it to users for information.&gt; &gt; &gt; You may (or may not) want to stop reading quickly :-)&gt; &gt; &gt;&gt; &gt; &gt; So, some of you may have noticed that the latest OpenSim revisions now&gt; &gt; &gt; have many more of the subject error messages on the console. The cause&gt; &gt; &gt; is the Mono Addins manager we're using, which writes these errors to the&gt; &gt; &gt; console if the dll doesn't contain the configuration data it's expecting.&gt; &gt; &gt;&gt; &gt; &gt; So today I looked at removing these errors. I had to follow several&gt; &gt; &gt; lines of investigation.&gt; &gt; &gt;&gt; &gt; &gt; 1. My initial thought was to move all the external libraries which are&gt; &gt; &gt; causing the problem to a separate $OPENSIM_ROOT/lib/ext directory.&gt; &gt; &gt; However, this means changes to make sure that the dlls can be found in&gt; &gt; &gt; the new directory. For a cross platform application, it's hard. On&gt; &gt; &gt; Microsoft's CLR we can simply use &lt;Probing&gt; in config files. However,&gt; &gt; &gt; Mono does appear to support this, at least according to&gt; &gt; &gt;&gt; &gt; &gt; <A HREF="http://www.mono-project.com/Assemblies_and_the_GAC">http://www.mono-project.com/Assemblies_and_the_GAC</A>&gt; &gt; &gt;&gt; &gt; &gt; I tried it anyway, without success. Instead, the only option on Mono is&gt; &gt; &gt; to either set the MONO_PATH or put the assemblies in the Global Assembly&gt; &gt; &gt; Cache.&gt; &gt; &gt;&gt; &gt; &gt; 2. This makes things awkward, so instead I looked at moving the plugin&gt; &gt; &gt; dlls. Same problem.&gt; &gt; &gt;&gt; &gt; &gt; 3. So instead I looked at simply suppressing the messages.&gt; &gt; &gt; Unfortunately, the Mono addins code writes these messages out to the&gt; &gt; &gt; console. Although in theory you could give it an IProgressMonitor and&gt; &gt; &gt; stop this, all the classes for this (and the interface) are internal and&gt; &gt; &gt; hence not accessible. Later versions of mono-addins than the one we are&gt; &gt; &gt; using would appear to have the same problem.&gt; &gt; &gt;&gt; &gt; &gt; So although we could hack the code in 3. to remove the message (or even&gt; &gt; &gt; replace or code our own plugin solution), the fact is that we really&gt; &gt; &gt; need to have dlls in different directories eventually anyway - bin/ is&gt; &gt; &gt; already overloaded. This means I'm forced to come back to suggestion&gt; &gt; &gt; 1. Putting things in the GAC is unrealistic at this stage I think, so&gt; &gt; &gt; I'm proposing that we move all the external libraries to&gt; &gt; &gt; $OPENSIM_ROOT/lib/ext and set the MONO_PATH environmental variable to&gt; &gt; &gt; point to this directory. Under Windows, we would instead put &lt;Probing&gt;&gt; &gt; &gt; entries in the executable's config files.&gt; &gt; &gt;&gt; &gt; &gt; I tried setting MONO_PATH programatically in OpenSimMain.cs, but the set&gt; &gt; &gt; doesn't look like it is exported so the load fails. The same path works&gt; &gt; &gt; fine when exported from the command line.&gt; &gt; &gt;&gt; &gt; &gt; If we go the MONO_PATH route, then I think we could provide shell&gt; &gt; &gt; scripts for all the executables to set the path and then launch the&gt; &gt; &gt; program, even though this is a little messy. The executable itself&gt; &gt; &gt; would complain loudly if it is not on Windows and MONO_PATH is unset&gt; &gt; &gt; (which would be inconvenient for Windows mono users, though there may&gt; &gt; &gt; not be that many of them).&gt; &gt; &gt;&gt; &gt; &gt; I'm open to constructive suggestions on this, particularly from core&gt; &gt; &gt; developers.&gt; &gt; &gt;&gt; &gt; &gt; --&gt; &gt; &gt; justincc&gt; &gt; &gt; Justin Clark-Casey&gt; &gt; &gt; <A HREF="http://justincc.wordpress.com">http://justincc.wordpress.com</A>&gt; &gt; &gt;&gt; &gt; &gt; _______________________________________________&gt; &gt; &gt; Opensim-dev mailing list&gt; &gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>&gt; &gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>&gt; &gt; &gt; &gt; &gt; &gt; ------------------------------------------------------------------------&gt; &gt; &gt; &gt; _______________________________________________&gt; &gt; Opensim-dev mailing list&gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>&gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>&gt; &gt; &gt; -- &gt; justincc&gt; Justin Clark-Casey&gt; <A HREF="http://justincc.wordpress.com">http://justincc.wordpress.com</A>&gt; _______________________________________________&gt; Opensim-dev mailing list&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">Opensim-dev at lists.berlios.de</A>&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-dev">https://lists.berlios.de/mailman/listinfo/opensim-dev</A>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/opensim-dev/attachments/20080420/30f6cf33/attachment.html">https://lists.berlios.de/pipermail/opensim-dev/attachments/20080420/30f6cf33/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001489.html">[Opensim-dev] [Opensim-users] Proposal for removing &quot;ERROR: There was an	error while scanning assembly:&quot; message
</A></li>
	<LI>Next message: <A HREF="001482.html">[Opensim-dev] Proposal for removing &quot;ERROR: There was an error while scanning assembly:&quot; message
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1476">[ date ]</a>
              <a href="thread.html#1476">[ thread ]</a>
              <a href="subject.html#1476">[ subject ]</a>
              <a href="author.html#1476">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-dev">More information about the Opensim-dev
mailing list</a><br>
</body></html>
